<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Habitat Layout Creator â€” MVP</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <div id="app">
    <aside class="sidebar">
      <h2>Catalog</h2>
      <div class="catalog">
        <div class="category-group">
          <button class="category-btn" data-category="basic">ğŸ”§ Basic Systems</button>
          <div class="category-menu" id="basic-menu" style="display: none;">
            <button class="item" data-type="bed">ğŸ›ï¸ Bed</button>
            <button class="item" data-type="panel">ğŸ–¥ï¸ Panel</button>
            <button class="item" data-type="cabinet">ğŸ“¦ Cabinet</button>
            <button class="item" data-type="cable">ğŸ§µ Cable (polyline)</button>
          </div>
        </div>

        <div class="category-group">
          <button class="category-btn" data-category="food">ğŸ½ï¸ Food Systems</button>
          <div class="category-menu" id="food-menu" style="display: none;">
            <button class="item" data-type="kitchen">ğŸ³ Kitchen</button>
            <button class="item" data-type="dining">ğŸ½ï¸ Dining</button>
            <button class="item" data-type="storage">ğŸ“¦ Storage</button>
          </div>
        </div>

        <div class="category-group">
          <button class="category-btn" data-category="life">ğŸŒ¬ï¸ Life Support</button>
          <div class="category-menu" id="life-menu" style="display: none;">
            <button class="item" data-type="atmosphere">ğŸŒ¬ï¸ Atmosphere Control</button>
            <button class="item" data-type="monitor">ğŸ“Š Monitor</button>
          </div>
        </div>

        <div class="category-group">
          <button class="category-btn" data-category="exercise">ğŸ’ª Exercise & Recreation</button>
          <div class="category-menu" id="exercise-menu" style="display: none;">
            <button class="item" data-type="exercise">ğŸ’ª Exercise</button>
            <button class="item" data-type="recreation">ğŸ® Recreation</button>
          </div>
        </div>

        <div class="category-group">
          <button class="category-btn" data-category="psychology">ğŸ§  Psychology & Privacy</button>
          <div class="category-menu" id="psychology-menu" style="display: none;">
            <button class="item" data-type="private">ğŸ”’ Private Space</button>
            <button class="item" data-type="communication">ğŸ“¡ Comm Station</button>
          </div>
        </div>
      </div>
      <h2>Modules</h2>
      <div class="modules-panel">
        <div id="module-list"></div>
        <div class="module-templates">
          <!-- <label>Template:</label>
          <select id="module-template">
            <option value="standard">Standard</option>
            <option value="compact">Compact</option>
            <option value="large">Large</option>
            <option value="wide">Wide</option>
            <option value="tall">Tall</option>
          </select> -->
        </div>
        <button id="btn-add-module">â• Add Module</button>
        <button id="btn-edit-module" style="display: none;">âœï¸ Edit Module</button>
        <button id="btn-delete-module" style="display: none;">ğŸ—‘ï¸ Delete Module</button>
        <button id="btn-overview">ğŸ‘ï¸ Overview Mode</button>
      </div>
      <h2>Tools</h2>
      <div class="tools">
        <button id="tool-select" class="tool active">ğŸ–±ï¸ Select/Move (V)</button>
        <button id="tool-cable" class="tool">ğŸ§µ Cable Tool (C)</button>
        <button id="tool-module" class="tool">ğŸ—ï¸ Module Tool (M)</button>
        <button id="tool-measure" class="tool">ğŸ“ Measure (Ruler)</button>
        <button id="btn-rotate">â†» Rotate (R)</button>
        <button id="btn-duplicate">â§‰ Duplicate (Ctrl+D)</button>
        <button id="btn-delete">ğŸ—‘ï¸ Delete (Del)</button>
        <button id="btn-undo">â†¶ Undo (Ctrl+Z)</button>
        <button id="btn-redo">â†· Redo (Ctrl+Y)</button>
      </div>
      <!-- <h2>Cable Tools</h2> -->
      <div class="tools" id="cable-tools" style="display: none;">
        <button id="btn-add-cable-point" class="tool">â• Add Point (+)</button>
        <button id="btn-remove-cable-point" class="tool">â– Remove Point (-)</button>
        <button id="btn-delete-cable" class="tool">ğŸ—‘ï¸ Delete Cable</button>
      </div>
      <h2>Statistics</h2>
      <div class="stats-panel">
        <div id="stats-display">
          <div>Objects: <span id="object-count">0</span></div>
          <div>Free Space: <span id="free-space">100%</span></div>
          <div>Issues: <span id="issue-count">0</span></div>
          <div>Total Area (mÂ²): <span id="total-area-m2">0</span></div>
          <div>Total Volume (mÂ³): <span id="total-vol-m3">0</span></div>
          <div>NASA Compliance: <span id="nasa-compliance">0%</span></div>
        </div>
      </div>
      <h2>Mission Params</h2>
      <div class="modules-panel">
        <div class="form-group">
          <label for="crew-size">Crew Size</label>
          <select id="crew-size">
            <option value="4">4</option>
            <option value="6">6</option>
          </select>
        </div>
        <div class="form-group">
          <label for="deck-height">Deck Height (m)</label>
          <input id="deck-height" type="number" min="2" max="5" step="0.1" value="2.4">
        </div>
        <div class="form-group">
          <label for="sizing-mode">Sizing Mode</label>
          <select id="sizing-mode">
            <option value="manual">Manual</option>
            <option value="nasa">NASA</option>
          </select>
        </div>
        <div class="form-group">
          <label for="zoning-dist">Zoning Min Distance (m)</label>
          <input id="zoning-dist" type="number" min="0" max="10" step="0.1" value="2">
        </div>
        <div class="form-group">
          <button id="preset-crew4-lunar" class="btn-primary">Preset: Crew-4 Lunar</button>
          <button id="preset-crew6-mars" class="btn-secondary">Preset: Crew-6 Mars</button>
        </div>
        <div class="form-group">
          <button id="btn-save-params" class="btn-primary">Apply / Save Params</button>
        </div>
        <div class="form-group">
          <button id="preset-demo-mars" class="tool">Quick Demo: Mars Transit</button>
          <button id="preset-demo-lunar" class="tool">Quick Demo: Lunar Base</button>
        </div>
      </div>
      <h2>Inspector</h2>
      <div class="modules-panel" id="inspector-panel">
        <div>Type: <span id="insp-type">â€”</span></div>
        <div>Size (m): <span id="insp-size">â€”</span></div>
        <div>Area (mÂ²): <span id="insp-area">â€”</span></div>
        <div>Volume (mÂ³): <span id="insp-volume">â€”</span></div>
        <div>Function: <span id="insp-function">â€”</span></div>
        <div>Meets NASA: <span id="insp-nasa">â€”</span></div>
      </div>
      <!-- <h2>AI Assistant</h2>
      <div class="ai-panel"> ... </div> -->
    </aside>
    <main>
      <header>
        <div class="left">
          <strong>Habitat Layout Creator â€” MVP</strong>
        </div>
        <div class="right">
          <button id="btn-ai">AI</button>
          <button id="btn-export">Export JSON</button>
          <button id="btn-import">Import JSON</button>
          <input id="import-file" type="file" accept="application/json" hidden />
          <button id="btn-reset">Reset</button>
        </div>
      </header>
      <section class="canvas-wrap">
        <canvas id="canvas"></canvas>
      </section>

      <footer>
        <small>
          Objects snap to grid. Tips: drag from catalog, select with click, rotate (R), delete (Del), undo (Ctrl+Z).
          Cable tools: select cable to edit points, use +/- to add/remove points, drag points to move them.
        </small>
      </footer>
    </main>
  </div>

  <!-- Module Configuration Modal -->
  <div id="module-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>ğŸ—ï¸ Configure New Module</h2>
        <span class="close">&times;</span>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label for="module-name">Module Name:</label>
          <input type="text" id="module-name" value="New Module" placeholder="Enter module name">
        </div>

        <div class="form-group">
          <label for="module-template-select">Template:</label>
          <select id="module-template-select">
            <option value="standard">Standard (1000x600)</option>
            <option value="compact">Compact (800x500)</option>
            <option value="large">Large (1200x700)</option>
            <option value="wide">Wide (1400x500)</option>
            <option value="tall">Tall (800x900)</option>
            <option value="custom">Custom Size</option>
          </select>
        </div>

        <div class="form-group" id="custom-size-group" style="display: none;">
          <label for="module-width">Width:</label>
          <input type="number" id="module-width" min="200" max="2000" value="1000">
          <label for="module-height">Height:</label>
          <input type="number" id="module-height" min="150" max="1500" value="600">
        </div>

        <div class="form-group">
          <label for="module-color">Module Color:</label>
          <input type="color" id="module-color" value="#0d1b26">
        </div>

        <div class="form-group">
          <label for="module-type">Module Type:</label>
          <select id="module-type">
            <option value="habitat">ğŸ  Habitat Module</option>
            <option value="laboratory">ğŸ”¬ Laboratory</option>
            <option value="storage">ğŸ“¦ Storage Module</option>
            <option value="greenhouse">ğŸŒ± Greenhouse</option>
            <option value="gym">ğŸ’ª Exercise Module</option>
            <option value="medical">ğŸ¥ Medical Bay</option>
          </select>
        </div>

      </div>
      <div class="modal-footer">
        <button id="btn-create-module" class="btn-primary">Create Module</button>
        <button id="btn-cancel-module" class="btn-secondary">Cancel</button>
      </div>
    </div>
  </div>

  <!-- Module Edit Modal -->
  <div id="edit-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>âœï¸ Edit Module</h2>
        <span class="close-edit">&times;</span>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label for="edit-module-name">Module Name:</label>
          <input type="text" id="edit-module-name" placeholder="Enter module name">
        </div>

        <div class="form-group">
          <label for="edit-module-width">Width:</label>
          <input type="number" id="edit-module-width" min="200" max="2000">
        </div>

        <div class="form-group">
          <label for="edit-module-height">Height:</label>
          <input type="number" id="edit-module-height" min="150" max="1500">
        </div>

        <div class="form-group">
          <label for="edit-module-color">Module Color:</label>
          <input type="color" id="edit-module-color">
        </div>

        <div class="form-group">
          <label for="edit-module-type">Module Type:</label>
          <select id="edit-module-type">
            <option value="habitat">ğŸ  Habitat Module</option>
            <option value="laboratory">ğŸ”¬ Laboratory</option>
            <option value="storage">ğŸ“¦ Storage Module</option>
            <option value="greenhouse">ğŸŒ± Greenhouse</option>
            <option value="gym">ğŸ’ª Exercise Module</option>
            <option value="medical">ğŸ¥ Medical Bay</option>
          </select>
        </div>
      </div>
      <div class="modal-footer">
        <button id="btn-save-module" class="btn-primary">Save Changes</button>
        <button id="btn-cancel-edit" class="btn-secondary">Cancel</button>
      </div>
    </div>
  </div>

  <div id="ai-floating-panel">
  <div class="ai-header">
    <h2>AI Assistant</h2>
    <button id="btn-close-ai">âœ–</button>
  </div>
  <div class="ai-panel">
    <label>Source:
      <select id="ai-source">
        <option value="local" selected>Local</option>
        <option value="gemini">Gemini (proxy)</option>
      </select>
    </label>
    <button id="btn-analyze">Analyze with AI</button>
    <ul id="ai-suggestions"></ul>
  </div>
</div>

  <div id="toast" role="status" aria-live="polite"></div>

  <script src="main.js"></script>
</body>

</html>